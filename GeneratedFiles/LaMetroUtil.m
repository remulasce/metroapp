//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/nighelles/Desktop/metroapp/app/src/main/java/com/remulasce/lametroapp/java_core/LaMetroUtil.java
//

#include "Agency.h"
#include "Arrival.h"
#include "Destination.h"
#include "IOSClass.h"
#include "J2ObjC_source.h"
#include "LaMetroUtil.h"
#include "Log.h"
#include "Route.h"
#include "RouteColor.h"
#include "RouteColorer.h"
#include "Stop.h"
#include "StopLocationTranslator.h"
#include "Vehicle.h"
#include "java/io/IOException.h"
#include "java/io/StringReader.h"
#include "java/lang/Exception.h"
#include "java/lang/Integer.h"
#include "java/util/ArrayList.h"
#include "java/util/List.h"
#include "javax/xml/parsers/DocumentBuilder.h"
#include "javax/xml/parsers/DocumentBuilderFactory.h"
#include "javax/xml/parsers/ParserConfigurationException.h"
#include "org/w3c/dom/Document.h"
#include "org/w3c/dom/Element.h"
#include "org/w3c/dom/Node.h"
#include "org/w3c/dom/NodeList.h"
#include "org/xml/sax/InputSource.h"
#include "org/xml/sax/SAXException.h"
#include "org/xmlpull/v1/XmlPullParser.h"
#include "org/xmlpull/v1/XmlPullParserException.h"
#include "org/xmlpull/v1/XmlPullParserFactory.h"

__attribute__((unused)) static id<JavaUtilList> ComRemulasceLametroappJava_coreLaMetroUtil_parseWithJavaLibsWithNSString_(NSString *response);
__attribute__((unused)) static NSString *ComRemulasceLametroappJava_coreLaMetroUtil_cleanupStopIDWithNSString_(NSString *stopIDAttribute);
__attribute__((unused)) static void ComRemulasceLametroappJava_coreLaMetroUtil_parseWithAndroidLibsWithNSString_withJavaUtilList_(NSString *response, id<JavaUtilList> ret);
__attribute__((unused)) static void ComRemulasceLametroappJava_coreLaMetroUtil_addNewArrivalWithJavaUtilList_withInt_withComRemulasceLametroappJava_coreBasic_typesDestination_withComRemulasceLametroappJava_coreBasic_typesRoute_withComRemulasceLametroappJava_coreBasic_typesStop_withComRemulasceLametroappJava_coreBasic_typesVehicle_(id<JavaUtilList> ret, jint seconds, ComRemulasceLametroappJava_coreBasic_typesDestination *d, ComRemulasceLametroappJava_coreBasic_typesRoute *r, ComRemulasceLametroappJava_coreBasic_typesStop *s, ComRemulasceLametroappJava_coreBasic_typesVehicle *v);

@interface ComRemulasceLametroappJava_coreLaMetroUtil () {
}

+ (id<JavaUtilList>)parseWithJavaLibsWithNSString:(NSString *)response;

+ (NSString *)cleanupStopIDWithNSString:(NSString *)stopIDAttribute;

+ (void)parseWithAndroidLibsWithNSString:(NSString *)response
                        withJavaUtilList:(id<JavaUtilList>)ret;

+ (void)addNewArrivalWithJavaUtilList:(id<JavaUtilList>)ret
                              withInt:(jint)seconds
withComRemulasceLametroappJava_coreBasic_typesDestination:(ComRemulasceLametroappJava_coreBasic_typesDestination *)d
withComRemulasceLametroappJava_coreBasic_typesRoute:(ComRemulasceLametroappJava_coreBasic_typesRoute *)r
withComRemulasceLametroappJava_coreBasic_typesStop:(ComRemulasceLametroappJava_coreBasic_typesStop *)s
withComRemulasceLametroappJava_coreBasic_typesVehicle:(ComRemulasceLametroappJava_coreBasic_typesVehicle *)v;
@end

@implementation ComRemulasceLametroappJava_coreLaMetroUtil

NSString * ComRemulasceLametroappJava_coreLaMetroUtil_NEXTBUS_FEED_URL_ = @"http://webservices.nextbus.com/service/publicXMLFeed";
NSString * ComRemulasceLametroappJava_coreLaMetroUtil_BART_FEED_URL_ = @"http://api.bart.gov/api/etd.aspx";
NSString * ComRemulasceLametroappJava_coreLaMetroUtil_BART_API_KEY_ = @"MW9S-E7SL-26DU-VV8V";
NSString * ComRemulasceLametroappJava_coreLaMetroUtil_TAG_ = @"LaMetroUtil";
id<ComRemulasceLametroappJava_coreStatic_dataStopLocationTranslator> ComRemulasceLametroappJava_coreLaMetroUtil_locationTranslator_;
id<ComRemulasceLametroappJava_coreStatic_dataRouteColorer> ComRemulasceLametroappJava_coreLaMetroUtil_routeColorer_;

+ (jboolean)isValidStopWithNSString:(NSString *)stop {
  return ComRemulasceLametroappJava_coreLaMetroUtil_isValidStopWithNSString_(stop);
}

+ (jboolean)isValidRouteWithComRemulasceLametroappJava_coreBasic_typesRoute:(ComRemulasceLametroappJava_coreBasic_typesRoute *)route {
  return ComRemulasceLametroappJava_coreLaMetroUtil_isValidRouteWithComRemulasceLametroappJava_coreBasic_typesRoute_(route);
}

+ (NSString *)makePredictionsRequestWithComRemulasceLametroappJava_coreBasic_typesStop:(ComRemulasceLametroappJava_coreBasic_typesStop *)stop
                                   withComRemulasceLametroappJava_coreBasic_typesRoute:(ComRemulasceLametroappJava_coreBasic_typesRoute *)route {
  return ComRemulasceLametroappJava_coreLaMetroUtil_makePredictionsRequestWithComRemulasceLametroappJava_coreBasic_typesStop_withComRemulasceLametroappJava_coreBasic_typesRoute_(stop, route);
}

+ (id<JavaUtilList>)parseAllArrivalsWithNSString:(NSString *)response {
  return ComRemulasceLametroappJava_coreLaMetroUtil_parseAllArrivalsWithNSString_(response);
}

+ (id<JavaUtilList>)parseWithJavaLibsWithNSString:(NSString *)response {
  return ComRemulasceLametroappJava_coreLaMetroUtil_parseWithJavaLibsWithNSString_(response);
}

+ (NSString *)cleanupStopIDWithNSString:(NSString *)stopIDAttribute {
  return ComRemulasceLametroappJava_coreLaMetroUtil_cleanupStopIDWithNSString_(stopIDAttribute);
}

+ (void)parseWithAndroidLibsWithNSString:(NSString *)response
                        withJavaUtilList:(id<JavaUtilList>)ret {
  ComRemulasceLametroappJava_coreLaMetroUtil_parseWithAndroidLibsWithNSString_withJavaUtilList_(response, ret);
}

+ (void)addNewArrivalWithJavaUtilList:(id<JavaUtilList>)ret
                              withInt:(jint)seconds
withComRemulasceLametroappJava_coreBasic_typesDestination:(ComRemulasceLametroappJava_coreBasic_typesDestination *)d
withComRemulasceLametroappJava_coreBasic_typesRoute:(ComRemulasceLametroappJava_coreBasic_typesRoute *)r
withComRemulasceLametroappJava_coreBasic_typesStop:(ComRemulasceLametroappJava_coreBasic_typesStop *)s
withComRemulasceLametroappJava_coreBasic_typesVehicle:(ComRemulasceLametroappJava_coreBasic_typesVehicle *)v {
  ComRemulasceLametroappJava_coreLaMetroUtil_addNewArrivalWithJavaUtilList_withInt_withComRemulasceLametroappJava_coreBasic_typesDestination_withComRemulasceLametroappJava_coreBasic_typesRoute_withComRemulasceLametroappJava_coreBasic_typesStop_withComRemulasceLametroappJava_coreBasic_typesVehicle_(ret, seconds, d, r, s, v);
}

+ (NSString *)timeToDisplayWithInt:(jint)seconds {
  return ComRemulasceLametroappJava_coreLaMetroUtil_timeToDisplayWithInt_(seconds);
}

+ (NSString *)standaloneTimeToDisplayWithInt:(jint)seconds {
  return ComRemulasceLametroappJava_coreLaMetroUtil_standaloneTimeToDisplayWithInt_(seconds);
}

+ (NSString *)standaloneSecondsRemainderTimeWithInt:(jint)seconds {
  return ComRemulasceLametroappJava_coreLaMetroUtil_standaloneSecondsRemainderTimeWithInt_(seconds);
}

+ (void)fillinAgencyAndStopIDWithJavaUtilList:(id<JavaUtilList>)arrivals
withComRemulasceLametroappJava_coreBasic_typesAgency:(ComRemulasceLametroappJava_coreBasic_typesAgency *)agency
                                 withNSString:(NSString *)stopID {
  ComRemulasceLametroappJava_coreLaMetroUtil_fillinAgencyAndStopIDWithJavaUtilList_withComRemulasceLametroappJava_coreBasic_typesAgency_withNSString_(arrivals, agency, stopID);
}

- (instancetype)init {
  return [super init];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "isValidStopWithNSString:", "isValidStop", "Z", 0x9, NULL },
    { "isValidRouteWithComRemulasceLametroappJava_coreBasic_typesRoute:", "isValidRoute", "Z", 0x9, NULL },
    { "makePredictionsRequestWithComRemulasceLametroappJava_coreBasic_typesStop:withComRemulasceLametroappJava_coreBasic_typesRoute:", "makePredictionsRequest", "Ljava.lang.String;", 0x9, NULL },
    { "parseAllArrivalsWithNSString:", "parseAllArrivals", "Ljava.util.List;", 0x9, NULL },
    { "parseWithJavaLibsWithNSString:", "parseWithJavaLibs", "Ljava.util.List;", 0xa, NULL },
    { "cleanupStopIDWithNSString:", "cleanupStopID", "Ljava.lang.String;", 0xa, NULL },
    { "parseWithAndroidLibsWithNSString:withJavaUtilList:", "parseWithAndroidLibs", "V", 0xa, NULL },
    { "addNewArrivalWithJavaUtilList:withInt:withComRemulasceLametroappJava_coreBasic_typesDestination:withComRemulasceLametroappJava_coreBasic_typesRoute:withComRemulasceLametroappJava_coreBasic_typesStop:withComRemulasceLametroappJava_coreBasic_typesVehicle:", "addNewArrival", "V", 0xa, NULL },
    { "timeToDisplayWithInt:", "timeToDisplay", "Ljava.lang.String;", 0x9, NULL },
    { "standaloneTimeToDisplayWithInt:", "standaloneTimeToDisplay", "Ljava.lang.String;", 0x9, NULL },
    { "standaloneSecondsRemainderTimeWithInt:", "standaloneSecondsRemainderTime", "Ljava.lang.String;", 0x9, NULL },
    { "fillinAgencyAndStopIDWithJavaUtilList:withComRemulasceLametroappJava_coreBasic_typesAgency:withNSString:", "fillinAgencyAndStopID", "V", 0x9, NULL },
    { "init", NULL, NULL, 0x1, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "NEXTBUS_FEED_URL_", NULL, 0x1a, "Ljava.lang.String;", &ComRemulasceLametroappJava_coreLaMetroUtil_NEXTBUS_FEED_URL_,  },
    { "BART_FEED_URL_", NULL, 0x1a, "Ljava.lang.String;", &ComRemulasceLametroappJava_coreLaMetroUtil_BART_FEED_URL_,  },
    { "BART_API_KEY_", NULL, 0x1a, "Ljava.lang.String;", &ComRemulasceLametroappJava_coreLaMetroUtil_BART_API_KEY_,  },
    { "TAG_", NULL, 0x19, "Ljava.lang.String;", &ComRemulasceLametroappJava_coreLaMetroUtil_TAG_,  },
    { "locationTranslator_", NULL, 0x9, "Lcom.remulasce.lametroapp.java_core.static_data.StopLocationTranslator;", &ComRemulasceLametroappJava_coreLaMetroUtil_locationTranslator_,  },
    { "routeColorer_", NULL, 0x9, "Lcom.remulasce.lametroapp.java_core.static_data.RouteColorer;", &ComRemulasceLametroappJava_coreLaMetroUtil_routeColorer_,  },
  };
  static const J2ObjcClassInfo _ComRemulasceLametroappJava_coreLaMetroUtil = { 2, "LaMetroUtil", "com.remulasce.lametroapp.java_core", NULL, 0x1, 13, methods, 6, fields, 0, NULL, 0, NULL};
  return &_ComRemulasceLametroappJava_coreLaMetroUtil;
}

@end

jboolean ComRemulasceLametroappJava_coreLaMetroUtil_isValidStopWithNSString_(NSString *stop) {
  ComRemulasceLametroappJava_coreLaMetroUtil_init();
  if (stop == nil) {
    return NO;
  }
  if ([((NSString *) nil_chk(stop)) isEmpty]) {
    return NO;
  }
  return YES;
}

jboolean ComRemulasceLametroappJava_coreLaMetroUtil_isValidRouteWithComRemulasceLametroappJava_coreBasic_typesRoute_(ComRemulasceLametroappJava_coreBasic_typesRoute *route) {
  ComRemulasceLametroappJava_coreLaMetroUtil_init();
  if (route == nil || ![route isValid]) {
    return NO;
  }
  return YES;
}

NSString *ComRemulasceLametroappJava_coreLaMetroUtil_makePredictionsRequestWithComRemulasceLametroappJava_coreBasic_typesStop_withComRemulasceLametroappJava_coreBasic_typesRoute_(ComRemulasceLametroappJava_coreBasic_typesStop *stop, ComRemulasceLametroappJava_coreBasic_typesRoute *route) {
  ComRemulasceLametroappJava_coreLaMetroUtil_init();
  ComRemulasceLametroappJava_coreBasic_typesAgency *agency = [((ComRemulasceLametroappJava_coreBasic_typesStop *) nil_chk(stop)) getAgency];
  if (agency == nil || ![agency isValid]) {
    ComRemulasceLametroappJava_coreAnalyticsLog_eWithNSString_withNSString_(ComRemulasceLametroappJava_coreLaMetroUtil_TAG_, @"No agency attached to stop, old functions removed. Specify the agency as part of your stops.");
    return nil;
  }
  NSString *URI = [NSString string];
  if ([((NSString *) nil_chk(((ComRemulasceLametroappJava_coreBasic_typesAgency *) nil_chk(agency))->raw_)) isEqual:@"BART"]) {
    URI = JreStrcat("$$$$$", ComRemulasceLametroappJava_coreLaMetroUtil_BART_FEED_URL_, @"?cmd=etd&orig=", [stop getString], @"&key=", ComRemulasceLametroappJava_coreLaMetroUtil_BART_API_KEY_);
  }
  else {
    URI = JreStrcat("$$$$$", ComRemulasceLametroappJava_coreLaMetroUtil_NEXTBUS_FEED_URL_, @"?command=predictions&a=", agency->raw_, @"&stopId=", [stop getString]);
    if (ComRemulasceLametroappJava_coreLaMetroUtil_isValidRouteWithComRemulasceLametroappJava_coreBasic_typesRoute_(route)) {
      URI = JreStrcat("$$", URI, JreStrcat("$$", @"&routeTag=", [((ComRemulasceLametroappJava_coreBasic_typesRoute *) nil_chk(route)) getString]));
    }
  }
  ComRemulasceLametroappJava_coreAnalyticsLog_wWithNSString_withNSString_(ComRemulasceLametroappJava_coreLaMetroUtil_TAG_, JreStrcat("$$", @"Request string: ", URI));
  return URI;
}

id<JavaUtilList> ComRemulasceLametroappJava_coreLaMetroUtil_parseAllArrivalsWithNSString_(NSString *response) {
  ComRemulasceLametroappJava_coreLaMetroUtil_init();
  if (response == nil || [response isEmpty]) {
    ComRemulasceLametroappJava_coreAnalyticsLog_dWithNSString_withNSString_(ComRemulasceLametroappJava_coreLaMetroUtil_TAG_, @"Error in input given to parseAllArrivals, possible network failure");
    return nil;
  }
  id<JavaUtilList> ret = ComRemulasceLametroappJava_coreLaMetroUtil_parseWithJavaLibsWithNSString_(response);
  return ret;
}

id<JavaUtilList> ComRemulasceLametroappJava_coreLaMetroUtil_parseWithJavaLibsWithNSString_(NSString *response) {
  ComRemulasceLametroappJava_coreLaMetroUtil_init();
  id<JavaUtilList> ret = [[JavaUtilArrayList alloc] init];
  JavaxXmlParsersDocumentBuilderFactory *dbf = JavaxXmlParsersDocumentBuilderFactory_newInstance();
  @try {
    JavaxXmlParsersDocumentBuilder *db = [((JavaxXmlParsersDocumentBuilderFactory *) nil_chk(dbf)) newDocumentBuilder];
    id<OrgW3cDomDocument> dom = [((JavaxXmlParsersDocumentBuilder *) nil_chk(db)) parseWithOrgXmlSaxInputSource:[[OrgXmlSaxInputSource alloc] initWithJavaIoReader:[[JavaIoStringReader alloc] initWithNSString:response]]];
    id<OrgW3cDomElement> docEle = [((id<OrgW3cDomDocument>) nil_chk(dom)) getDocumentElement];
    id<OrgW3cDomNodeList> errors = [((id<OrgW3cDomElement>) nil_chk(docEle)) getElementsByTagNameWithNSString:@"Error"];
    if (errors != nil && [errors getLength] != 0) {
      ComRemulasceLametroappJava_coreAnalyticsLog_dWithNSString_withNSString_(ComRemulasceLametroappJava_coreLaMetroUtil_TAG_, @"NexTrip/GTFS returned an error");
      return nil;
    }
    id<OrgW3cDomNodeList> uriTags = [docEle getElementsByTagNameWithNSString:@"uri"];
    NSString *directionAttribute = [NSString string];
    NSString *routeAttribute = [NSString string];
    NSString *stopIDAttribute = [NSString string];
    NSString *stopTitleAttribute = [NSString string];
    NSString *vehicleAttribute = [NSString string];
    jint seconds = 0;
    if (uriTags != nil && [uriTags getLength] > 0) {
      id<OrgW3cDomElement> station = (id<OrgW3cDomElement>) check_protocol_cast([((id<OrgW3cDomNodeList>) nil_chk([docEle getElementsByTagNameWithNSString:@"station"])) itemWithInt:0], @protocol(OrgW3cDomElement));
      stopIDAttribute = [((id<OrgW3cDomNode>) nil_chk([((id<OrgW3cDomNodeList>) nil_chk([((id<OrgW3cDomElement>) nil_chk(station)) getElementsByTagNameWithNSString:@"abbr"])) itemWithInt:0])) getTextContent];
      stopTitleAttribute = [((id<OrgW3cDomNode>) nil_chk([((id<OrgW3cDomNodeList>) nil_chk([station getElementsByTagNameWithNSString:@"name"])) itemWithInt:0])) getTextContent];
      id<OrgW3cDomNodeList> predictions = [docEle getElementsByTagNameWithNSString:@"etd"];
      if (predictions != nil && [predictions getLength] > 0) {
        for (jint i = 0; i < [predictions getLength]; i++) {
          id<OrgW3cDomElement> prediction = (id<OrgW3cDomElement>) check_protocol_cast([predictions itemWithInt:i], @protocol(OrgW3cDomElement));
          id<OrgW3cDomNodeList> directions = [((id<OrgW3cDomElement>) nil_chk(prediction)) getElementsByTagNameWithNSString:@"destination"];
          if (directions != nil && [directions getLength] > 0) {
            id<OrgW3cDomElement> direction = (id<OrgW3cDomElement>) check_protocol_cast([directions itemWithInt:0], @protocol(OrgW3cDomElement));
            directionAttribute = [((id<OrgW3cDomElement>) nil_chk(direction)) getTextContent];
          }
          id<OrgW3cDomNodeList> arrivals = [prediction getElementsByTagNameWithNSString:@"estimate"];
          for (jint j = 0; j < [((id<OrgW3cDomNodeList>) nil_chk(arrivals)) getLength]; j++) {
            id<OrgW3cDomElement> arrival = (id<OrgW3cDomElement>) check_protocol_cast([arrivals itemWithInt:j], @protocol(OrgW3cDomElement));
            jint minutes;
            @try {
              minutes = JavaLangInteger_parseIntWithNSString_([((id<OrgW3cDomNode>) nil_chk([((id<OrgW3cDomNodeList>) nil_chk([((id<OrgW3cDomElement>) nil_chk(arrival)) getElementsByTagNameWithNSString:@"minutes"])) itemWithInt:0])) getTextContent]);
            }
            @catch (JavaLangException *e) {
              minutes = 0;
            }
            seconds = minutes * 60;
            routeAttribute = [((id<OrgW3cDomNode>) nil_chk([((id<OrgW3cDomNodeList>) nil_chk([prediction getElementsByTagNameWithNSString:@"abbreviation"])) itemWithInt:0])) getTextContent];
            vehicleAttribute = [((id<OrgW3cDomNode>) nil_chk([((id<OrgW3cDomNodeList>) nil_chk([prediction getElementsByTagNameWithNSString:@"length"])) itemWithInt:0])) getTextContent];
            ComRemulasceLametroappJava_coreBasic_typesDestination *d = [[ComRemulasceLametroappJava_coreBasic_typesDestination alloc] initWithNSString:directionAttribute];
            ComRemulasceLametroappJava_coreBasic_typesRoute *r = [[ComRemulasceLametroappJava_coreBasic_typesRoute alloc] initWithNSString:routeAttribute];
            ComRemulasceLametroappJava_coreBasic_typesStop *s = [[ComRemulasceLametroappJava_coreBasic_typesStop alloc] initWithNSString:stopIDAttribute];
            ComRemulasceLametroappJava_coreBasic_typesVehicle *v = [[ComRemulasceLametroappJava_coreBasic_typesVehicle alloc] initWithNSString:vehicleAttribute];
            [s setStopNameWithNSString:stopTitleAttribute];
            ComRemulasceLametroappJava_coreLaMetroUtil_addNewArrivalWithJavaUtilList_withInt_withComRemulasceLametroappJava_coreBasic_typesDestination_withComRemulasceLametroappJava_coreBasic_typesRoute_withComRemulasceLametroappJava_coreBasic_typesStop_withComRemulasceLametroappJava_coreBasic_typesVehicle_(ret, seconds, d, r, s, nil);
          }
        }
      }
    }
    else {
      id<OrgW3cDomNodeList> predictions = [docEle getElementsByTagNameWithNSString:@"predictions"];
      if (predictions != nil && [predictions getLength] > 0) {
        for (jint i = 0; i < [predictions getLength]; i++) {
          id<OrgW3cDomElement> prediction = (id<OrgW3cDomElement>) check_protocol_cast([predictions itemWithInt:i], @protocol(OrgW3cDomElement));
          id<OrgW3cDomNodeList> directions = [((id<OrgW3cDomElement>) nil_chk(prediction)) getElementsByTagNameWithNSString:@"direction"];
          for (jint j = 0; j < [((id<OrgW3cDomNodeList>) nil_chk(directions)) getLength]; j++) {
            id<OrgW3cDomElement> direction = (id<OrgW3cDomElement>) check_protocol_cast([directions itemWithInt:j], @protocol(OrgW3cDomElement));
            id<OrgW3cDomNodeList> arrivals = [((id<OrgW3cDomElement>) nil_chk(direction)) getElementsByTagNameWithNSString:@"prediction"];
            for (jint k = 0; k < [((id<OrgW3cDomNodeList>) nil_chk(arrivals)) getLength]; k++) {
              id<OrgW3cDomElement> arrival = (id<OrgW3cDomElement>) check_protocol_cast([arrivals itemWithInt:k], @protocol(OrgW3cDomElement));
              seconds = JavaLangInteger_parseIntWithNSString_([((id<OrgW3cDomElement>) nil_chk(arrival)) getAttributeWithNSString:@"seconds"]);
              directionAttribute = [direction getAttributeWithNSString:@"title"];
              routeAttribute = [prediction getAttributeWithNSString:@"routeTag"];
              stopTitleAttribute = [prediction getAttributeWithNSString:@"stopTitle"];
              vehicleAttribute = [arrival getAttributeWithNSString:@"vehicle"];
              ComRemulasceLametroappJava_coreBasic_typesDestination *d = [[ComRemulasceLametroappJava_coreBasic_typesDestination alloc] initWithNSString:directionAttribute];
              ComRemulasceLametroappJava_coreBasic_typesRoute *r = [[ComRemulasceLametroappJava_coreBasic_typesRoute alloc] initWithNSString:routeAttribute];
              ComRemulasceLametroappJava_coreBasic_typesStop *s = [[ComRemulasceLametroappJava_coreBasic_typesStop alloc] initWithNSString:stopIDAttribute];
              ComRemulasceLametroappJava_coreBasic_typesVehicle *v = [[ComRemulasceLametroappJava_coreBasic_typesVehicle alloc] initWithNSString:vehicleAttribute];
              [s setStopNameWithNSString:stopTitleAttribute];
              ComRemulasceLametroappJava_coreLaMetroUtil_addNewArrivalWithJavaUtilList_withInt_withComRemulasceLametroappJava_coreBasic_typesDestination_withComRemulasceLametroappJava_coreBasic_typesRoute_withComRemulasceLametroappJava_coreBasic_typesStop_withComRemulasceLametroappJava_coreBasic_typesVehicle_(ret, seconds, d, r, s, v);
            }
          }
        }
      }
    }
  }
  @catch (JavaxXmlParsersParserConfigurationException *pce) {
    [((JavaxXmlParsersParserConfigurationException *) nil_chk(pce)) printStackTrace];
    return nil;
  }
  @catch (OrgXmlSaxSAXException *se) {
    [((OrgXmlSaxSAXException *) nil_chk(se)) printStackTrace];
    return nil;
  }
  @catch (JavaIoIOException *ioe) {
    [((JavaIoIOException *) nil_chk(ioe)) printStackTrace];
    return nil;
  }
  @catch (JavaLangException *e) {
    ComRemulasceLametroappJava_coreAnalyticsLog_wWithNSString_withNSString_(ComRemulasceLametroappJava_coreLaMetroUtil_TAG_, JreStrcat("$$", @"Unaddressed exception! ", [((JavaLangException *) nil_chk(e)) getMessage]));
    return nil;
  }
  return ret;
}

NSString *ComRemulasceLametroappJava_coreLaMetroUtil_cleanupStopIDWithNSString_(NSString *stopIDAttribute) {
  ComRemulasceLametroappJava_coreLaMetroUtil_init();
  jint indexOf_ = [((NSString *) nil_chk(stopIDAttribute)) indexOf:'_'];
  if (indexOf_ > 0) {
    stopIDAttribute = [stopIDAttribute substring:0 endIndex:[stopIDAttribute indexOf:'_']];
  }
  return stopIDAttribute;
}

void ComRemulasceLametroappJava_coreLaMetroUtil_parseWithAndroidLibsWithNSString_withJavaUtilList_(NSString *response, id<JavaUtilList> ret) {
  ComRemulasceLametroappJava_coreLaMetroUtil_init();
  OrgXmlpullV1XmlPullParserFactory *factory;
  @try {
    factory = OrgXmlpullV1XmlPullParserFactory_newInstance();
    [((OrgXmlpullV1XmlPullParserFactory *) nil_chk(factory)) setNamespaceAwareWithBoolean:YES];
    id<OrgXmlpullV1XmlPullParser> xpp = [factory newPullParser];
    [((id<OrgXmlpullV1XmlPullParser>) nil_chk(xpp)) setInputWithJavaIoReader:[[JavaIoStringReader alloc] initWithNSString:response]];
    jint eventType = [xpp getEventType];
    NSString *curStopName = @"";
    NSString *curDestination = @"";
    NSString *curRoute = @"";
    NSString *curStopTag = @"";
    while (eventType != OrgXmlpullV1XmlPullParser_END_DOCUMENT) {
      if (eventType == OrgXmlpullV1XmlPullParser_START_DOCUMENT) {
      }
      else if (eventType == OrgXmlpullV1XmlPullParser_START_TAG) {
        NSString *name = [xpp getName];
        if ([((NSString *) nil_chk(name)) isEqual:@"predictions"]) {
          curStopTag = [xpp getAttributeValueWithNSString:nil withNSString:@"stopTag"];
          curStopName = [xpp getAttributeValueWithNSString:nil withNSString:@"stopTitle"];
          curRoute = [xpp getAttributeValueWithNSString:nil withNSString:@"routeTag"];
        }
        if ([name isEqual:@"direction"]) {
          curDestination = [xpp getAttributeValueWithNSString:nil withNSString:@"title"];
        }
        if ([name isEqual:@"prediction"]) {
          NSString *vehicleNum;
          jint seconds = -1;
          NSString *timeString = [xpp getAttributeValueWithNSString:nil withNSString:@"seconds"];
          seconds = [JavaLangInteger_valueOfWithNSString_(timeString) intValue];
          vehicleNum = [xpp getAttributeValueWithNSString:nil withNSString:@"vehicle"];
          jboolean updated = NO;
          for (ComRemulasceLametroappJava_coreDynamic_dataTypesArrival * __strong aa in nil_chk(ret)) {
            if ([((ComRemulasceLametroappJava_coreBasic_typesDestination *) nil_chk([((ComRemulasceLametroappJava_coreDynamic_dataTypesArrival *) nil_chk(aa)) getDirection])) isEqual:curDestination]) {
              updated = YES;
              if ([aa getEstimatedArrivalSeconds] > seconds) {
                [aa setEstimatedArrivalSecondsWithFloat:seconds];
              }
            }
          }
          if (!updated) {
            curStopTag = ComRemulasceLametroappJava_coreLaMetroUtil_cleanupStopIDWithNSString_(curStopTag);
            ComRemulasceLametroappJava_coreBasic_typesDestination *d = [[ComRemulasceLametroappJava_coreBasic_typesDestination alloc] initWithNSString:curDestination];
            ComRemulasceLametroappJava_coreBasic_typesRoute *r = [[ComRemulasceLametroappJava_coreBasic_typesRoute alloc] initWithNSString:curRoute];
            ComRemulasceLametroappJava_coreBasic_typesStop *s = [[ComRemulasceLametroappJava_coreBasic_typesStop alloc] initWithNSString:curStopTag];
            [s setStopNameWithNSString:curStopName];
            ComRemulasceLametroappJava_coreBasic_typesVehicle *v = [[ComRemulasceLametroappJava_coreBasic_typesVehicle alloc] initWithNSString:vehicleNum];
            ComRemulasceLametroappJava_coreLaMetroUtil_addNewArrivalWithJavaUtilList_withInt_withComRemulasceLametroappJava_coreBasic_typesDestination_withComRemulasceLametroappJava_coreBasic_typesRoute_withComRemulasceLametroappJava_coreBasic_typesStop_withComRemulasceLametroappJava_coreBasic_typesVehicle_(ret, seconds, d, r, s, v);
          }
        }
      }
      else if (eventType == OrgXmlpullV1XmlPullParser_END_TAG) {
      }
      else if (eventType == OrgXmlpullV1XmlPullParser_TEXT) {
      }
      eventType = [xpp next];
    }
  }
  @catch (OrgXmlpullV1XmlPullParserException *e1) {
    [((OrgXmlpullV1XmlPullParserException *) nil_chk(e1)) printStackTrace];
  }
  @catch (JavaIoIOException *e) {
    [((JavaIoIOException *) nil_chk(e)) printStackTrace];
  }
}

void ComRemulasceLametroappJava_coreLaMetroUtil_addNewArrivalWithJavaUtilList_withInt_withComRemulasceLametroappJava_coreBasic_typesDestination_withComRemulasceLametroappJava_coreBasic_typesRoute_withComRemulasceLametroappJava_coreBasic_typesStop_withComRemulasceLametroappJava_coreBasic_typesVehicle_(id<JavaUtilList> ret, jint seconds, ComRemulasceLametroappJava_coreBasic_typesDestination *d, ComRemulasceLametroappJava_coreBasic_typesRoute *r, ComRemulasceLametroappJava_coreBasic_typesStop *s, ComRemulasceLametroappJava_coreBasic_typesVehicle *v) {
  ComRemulasceLametroappJava_coreLaMetroUtil_init();
  ComRemulasceLametroappJava_coreAnalyticsLog_vWithNSString_withNSString_(ComRemulasceLametroappJava_coreLaMetroUtil_TAG_, JreStrcat("$IC@C@C@C@", @"Adding new arrival ", seconds, ' ', d, ' ', r, ' ', s, ' ', v));
  if (ComRemulasceLametroappJava_coreLaMetroUtil_locationTranslator_ != nil) {
  }
  if (ComRemulasceLametroappJava_coreLaMetroUtil_routeColorer_ != nil) {
    [((ComRemulasceLametroappJava_coreBasic_typesRoute *) nil_chk(r)) setColorWithComRemulasceLametroappJava_coreStatic_dataTypesRouteColor:[ComRemulasceLametroappJava_coreLaMetroUtil_routeColorer_ getColorWithComRemulasceLametroappJava_coreBasic_typesRoute:r]];
  }
  ComRemulasceLametroappJava_coreDynamic_dataTypesArrival *a = [[ComRemulasceLametroappJava_coreDynamic_dataTypesArrival alloc] init];
  [a setDestinationWithComRemulasceLametroappJava_coreBasic_typesDestination:d];
  [a setRouteWithComRemulasceLametroappJava_coreBasic_typesRoute:r];
  [a setStopWithComRemulasceLametroappJava_coreBasic_typesStop:s];
  [a setEstimatedArrivalSecondsWithFloat:seconds];
  [a setVehicleWithComRemulasceLametroappJava_coreBasic_typesVehicle:v];
  [((id<JavaUtilList>) nil_chk(ret)) addWithId:a];
}

NSString *ComRemulasceLametroappJava_coreLaMetroUtil_timeToDisplayWithInt_(jint seconds) {
  ComRemulasceLametroappJava_coreLaMetroUtil_init();
  if (seconds > 60) {
    return JreStrcat("$$", @"in ", ComRemulasceLametroappJava_coreLaMetroUtil_standaloneTimeToDisplayWithInt_(seconds));
  }
  if (seconds > 1) {
    return JreStrcat("$$", @"in ", ComRemulasceLametroappJava_coreLaMetroUtil_standaloneTimeToDisplayWithInt_(seconds));
  }
  if (seconds == 0) {
    return JreStrcat("$$", @"in ", ComRemulasceLametroappJava_coreLaMetroUtil_standaloneTimeToDisplayWithInt_(seconds));
  }
  return ComRemulasceLametroappJava_coreLaMetroUtil_standaloneTimeToDisplayWithInt_(seconds);
}

NSString *ComRemulasceLametroappJava_coreLaMetroUtil_standaloneTimeToDisplayWithInt_(jint seconds) {
  ComRemulasceLametroappJava_coreLaMetroUtil_init();
  if (seconds > 60) {
    return JreStrcat("$$", NSString_valueOfInt_(seconds / 60), @" min");
  }
  if (seconds >= 1) {
    return JreStrcat("$C", NSString_valueOfInt_(seconds), 's');
  }
  return @"arrived";
}

NSString *ComRemulasceLametroappJava_coreLaMetroUtil_standaloneSecondsRemainderTimeWithInt_(jint seconds) {
  ComRemulasceLametroappJava_coreLaMetroUtil_init();
  if (seconds <= 60) {
    return @"";
  }
  return JreStrcat("IC", (seconds % 60), 's');
}

void ComRemulasceLametroappJava_coreLaMetroUtil_fillinAgencyAndStopIDWithJavaUtilList_withComRemulasceLametroappJava_coreBasic_typesAgency_withNSString_(id<JavaUtilList> arrivals, ComRemulasceLametroappJava_coreBasic_typesAgency *agency, NSString *stopID) {
  ComRemulasceLametroappJava_coreLaMetroUtil_init();
  if (arrivals == nil) {
    return;
  }
  for (ComRemulasceLametroappJava_coreDynamic_dataTypesArrival * __strong a in nil_chk(arrivals)) {
    if ([((ComRemulasceLametroappJava_coreBasic_typesStop *) nil_chk([((ComRemulasceLametroappJava_coreDynamic_dataTypesArrival *) nil_chk(a)) getStop])) getAgency] != nil || [((ComRemulasceLametroappJava_coreBasic_typesRoute *) nil_chk([a getRoute])) getAgency] != nil) {
      ComRemulasceLametroappJava_coreAnalyticsLog_wWithNSString_withNSString_(ComRemulasceLametroappJava_coreLaMetroUtil_TAG_, @"fillinAgency tried to fill an agency that already existed");
      return;
    }
    [((ComRemulasceLametroappJava_coreBasic_typesStop *) nil_chk([a getStop])) setAgencyWithComRemulasceLametroappJava_coreBasic_typesAgency:agency];
    [((ComRemulasceLametroappJava_coreBasic_typesRoute *) nil_chk([a getRoute])) setAgencyWithComRemulasceLametroappJava_coreBasic_typesAgency:agency];
    [((ComRemulasceLametroappJava_coreBasic_typesStop *) nil_chk([a getStop])) setStopIDWithNSString:stopID];
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ComRemulasceLametroappJava_coreLaMetroUtil)
